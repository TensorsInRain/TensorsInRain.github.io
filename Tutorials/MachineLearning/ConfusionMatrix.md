# Confusion Matrix: A Measure of Classifier Performance

[Home](../../README.md) -- [Tutorials](../../Tutorials/README.md) -- [Blog](../../Blog/README.md) -- [About Me](../../aboutme.md) -- [Contact](../../contactme.md) -- [Resume](../../Resume.pdf) -- [Copyright](../../copyright.md)

November 2, 2020

## What is a confusion matrix?

A confusion matrix is a way to evaluate the performance of a classifier by visualizing how many times the classifier correctly predicted a classification and how many times a classification was incorrectly predicted.


## Confusion Matrix for a Binary Classifier
A binary classifier is a classifier that sorts the data into two classes.  Let's consider data that has the following two labels: "True" and "False"

![Binary Confusion Matrix](Images/ConfusionMatrix_Binary.png)


## Examples

### Example 1: Simple Binary Data

First, let's see how a confusion matrix works without using any machine learning algorithms.  We will do this by manually generating expected and predicted data sets.  For simplicity, let's generate what data could look like from a binary classifier with the classes "0" and "1".  The list "expected" contains the true classifications of the data while the list "predicted" contains the labels that would be generated by the machine learning algorithm.

```python
expected =  [0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0]
predicted = [0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0]
```

Next, let's examine how many 1's and 0's are in both of our data sets.  Ideally "expected" and "predicted" will contain  the same number of 0's and 1's, but in practice that is rarely the case.

```python
number_1s_expected = expected.count(1)
number_0s_expected = expected.count(0)
print ("Number of 1's expected: ", number_1s_expected)
print ("Number of 0's expected: ", number_0s_expected)

print()

number_1s_predicted = predicted.count(1)
number_0s_predicted = predicted.count(0)
print ("Number of 1's predicted: ", number_1s_predicted)
print ("Number of 0's predicted: ", number_0s_predicted)
```

Code Output:
```
Number of 1's expected:  15
Number of 0's expected:  15

Number of 1's predicted:  14
Number of 0's predicted:  16
```

From the above output we can see that the model predicts one less 1 than expected, but one more 0.  Ideally that means that one of the 1's got misclassified as a 0, which means that our algorithm only made one mistake.  However, analyzing the data like this can be misleading, as we will see below.

Let's import the confusion matrix method from Scikit-Learn.  This method takes two lists as arguments (the true values and the predicted values) and returns a confusion matrix.  Let's use this method to generate the confusion matrix and then print it to see what it looks like.

```python
from sklearn.metrics import confusion_matrix

CM = confusion_matrix(expected, predicted)

print(CM)
```
Code Output:
```
[[11  4]
 [ 5 10]]
```

```python
print("Number of zeros predicted as zeros: ",  CM[0][0])
print("Number of zeros predicted as ones: ", CM[0][1])

print ()

print("Number of ones predicted as zeros: ",  CM[1][0])
print("Number of ones predicted as ones: ", CM[1][1])
```

```
Number of zeros predicted as zeros 11
Number of zeros predicted as ones 4

Number of ones predicted as zeros 5
Number of ones predicted as ones 10
```

```python
print("Total number of correct predictions: ", CM[0][0] + CM[1][1])
print("Total number of incorrect predictins: ", CM[0][1] + CM[1][0])
```

```
Total number of correct predictions:  21
Total number of incorrect predictins:  9
```

```
import matplotlib.pyplot as plt
plt.matshow(CM, cmap=plt.cm.plasma)
plt.colorbar()

plt.xticks([0, 1])
plt.yticks([0, 1])
```



## References


# Copyright Notice
Linear Regression: A Simple Introduction to Machine Learning
Copyright (C) 2020  Julie Hartley

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
